Install
=======

This section contains the instruction to install ``BioImagePy`` and the toolboxes configuration files
to have a local working instance of ``BioImagePy``

Install BioImagePy
------------------

To install ``BioImagePy``, copy the python sources and run pip install:

.. code-block:: shell

    mkdir bioimageit
    git clone https://gitlab.inria.fr/bioimage-it/bioimagepy.git
    cd bioimagepy
    python3 -m pip install bioimagepy


Install toolboxes
-----------------

``BioImagePy`` uses a toolboxes index of remotely packaged tools. The toolboxes index is not installed by default. To install the
toolboxes run the following commands:

.. code-block:: shell

    cd bioimageit
    git clone https://gitlab.inria.fr/bioimage-it/toolboxes.git
    cd bioimagepy
    python3 install.py

The install script unpack the toolboxes, and create a configuration file. The install script ask your user name. This is the username
that will appear in the metadata files generated by ``BioImagePy``

Configure BioImagePy
--------------------

If you need to manually configure ``BioImagePy`` you need to edit the ``config.json`` file. You copy & paste 
the ``config.sample.json`` available in the ``BioImagePy`` root directory, or you can use the ``config.json``
file generated by the install script. The configuration file looks like this:

.. code-block:: javascript

    {
        "metadata": {
            "service": "LOCAL"
        },
        "process": {
            "service": "LOCAL",
            "xml_dirs": [
                "/use/absolute/path/to/bioimageit/toolboxes/tools"
            ],
            "categories": "/use/absolute/path/to/bioimageit/toolboxes/toolboxes.json",
            "tools": "/use/absolute/path/to/bioimageit/toolboxes/tools.json"
        },
        "runner": {
            "service": "SINGULARITY"
        },
        "user": {
            "name": "your user name"
        }
    } 

The ``metadata`` section allows to configure how the metadata are handled. In the exemple above, we use the LOCAL service that 
have no settings.

The ``process`` section contains all the processing tools desciptions. In the example above, we use the LOCAL service meaning 
that all the tools informations (XML wrappers) are copied locally. The variable ``xml_dirs`` is the path of the directories 
containing the processing tools XML wrappers. The variable ``categories`` is the path to the JSON file containing the 
toolboxes list. The variable ``tools`` is the path to the index file containing the list of all the availables tools. 

The ``runner`` section contains the processing tools runner configuration. In the example above, we use Singularity to run tools
that are packaged in Docker containers.

Finally, the ``user`` section contains the user name that will be printed in the metadata every time a data is imported or 
processed by this instance of ``BioImagePy``. This allows traceability.
